# ADR-002: 4계층 온톨로지 설계 결정

## 상태

Accepted

## 배경

비즈니스 프로세스 데이터를 체계적으로 구조화하여 지식그래프를 구축해야 한다. 단순 테이블/컬럼 메타데이터를 넘어, 프로젝트의 자원-절차-지표-성과를 계층적으로 표현하고 역방향 추적(KPI → 근본 원인)을 가능하게 해야 한다.

K-AIR 프로젝트에서 "Resource → Process → Measure → KPI" 4계층 온톨로지가 설계되었으나 구현되지 않았다 (0%). Axiom은 이 설계를 비즈니스 프로세스 인텔리전스 도메인에 맞게 재정의하여 최초 구현한다.

## 검토한 옵션

### 옵션 1: 4계층 온톨로지 (Resource → Process → Measure → KPI)

- K-AIR 설계를 비즈니스 프로세스 도메인에 적용
- 명확한 계층 분리, 방향성 있는 관계
- 역방향 추적: KPI → Measure → Process → Resource
- 순방향 예측: Resource → Process → Measure → KPI

### 옵션 2: 2계층 온톨로지 (Entity → Relationship 만)

- 단순한 개체-관계 모델
- 계층 구분 없이 모든 노드를 동일하게 취급
- 장점: 설계 단순, 유연성 높음
- 단점: 구조적 의미 부재, 역방향 추적 불가

### 옵션 3: 5계층 온톨로지 (+ Strategy 계층)

- 4계층에 전략 계층 추가
- 장점: BSC (Balanced Scorecard) 완전 모델링
- 단점: 비즈니스 프로세스 도메인에서 전략 계층의 실익 불분명, 복잡성 증가

### 옵션 4: 자유 그래프 (계층 없음)

- 타입 구분 없는 순수 그래프
- 관계만으로 구조 표현
- 장점: 최대 유연성
- 단점: 쿼리 복잡, 데이터 품질 관리 불가, AI 활용 어려움

## 선택한 결정

**4계층 온톨로지 (Resource → Process → Measure → KPI)** 를 선택한다.

## 근거

1. **역방향 추적 지원**: "프로세스 효율성이 50%인 이유"를 KPI → Measure(매출/비용) → Process(분석 절차) → Resource(자산, 조직) 순으로 기계적으로 역추적 가능

2. **영향도 분석 지원**: "자산 A를 매각하면 어떤 KPI가 변하는가?"를 Resource → Process → Measure → KPI 순으로 순방향 탐색 가능

3. **데이터 품질 검증**: 각 노드가 반드시 상위/하위 관계를 가져야 하므로, 고아 노드(orphan)를 구조적으로 검출 가능

4. **AI/LLM 활용**: 온톨로지 계층 정보가 NL2SQL 컨텍스트와 근본원인 분석의 구조적 프레임워크를 제공

5. **K-AIR 설계 검증**: 기존 도메인에서 설계된 구조가 비즈니스 프로세스 도메인에도 자연스럽게 매핑됨:
   - K-AIR Resource(설비, 인프라) → Axiom Resource(회사, 자산, 계약)
   - K-AIR Process(운영, 점검) → Axiom Process(데이터 수집, 분석, 최적화)
   - K-AIR Measure(유량, 수위) → Axiom Measure(매출, 비용, 영업이익)
   - K-AIR KPI(안전등급) → Axiom KPI(프로세스 효율성, 비용 절감률)

6. **적정 복잡도**: 2계층은 너무 단순하고, 5계층은 과도하다. 4계층이 비즈니스 프로세스 도메인의 자연스러운 추상화 단계와 일치

## 비즈니스 프로세스 도메인 노드 유형 결정

### Resource 계층

| 유형 | 선택 근거 |
|------|----------|
| Company | 모든 비즈니스 프로세스의 핵심 주체 (대상 조직, 이해관계자) |
| Asset | 조직 자산의 핵심 구성. 프로세스 운영의 기반 |
| Employee | 인적 자원은 프로세스 수행의 핵심 요소 |
| CashReserve | 조직의 유동성 관리 핵심 |
| Inventory | 재고 자산 관리 및 프로세스 투입 자원 |
| Financial | 재무 상태가 프로세스 성과 분석의 기초 |
| Contract | 거래 관계와 협력 구조를 표현 |

### Process 계층

| 유형 | 선택 근거 |
|------|----------|
| DataCollection | 모든 비즈니스 분석의 시작점 |
| ProcessAnalysis | 현황 파악은 최적화의 전제조건 |
| Optimization | 프로세스 개선이 KPI 향상의 핵심 |
| Execution | 실행 단계가 KPI의 직접 입력 |
| Review | 성과 검토가 피드백 루프의 핵심 절차 |

### Measure 계층

| 유형 | 선택 근거 |
|------|----------|
| Revenue | 프로세스 효율성 산출의 핵심 지표 |
| Cost | 비용 절감률 산출의 기초 |
| OperatingProfit | 수익성 분석의 핵심 |
| Throughput | 프로세스 처리량 측정 |
| CycleTime | 프로세스 소요 시간 측정 |

### KPI 계층

| 유형 | 선택 근거 |
|------|----------|
| ProcessEfficiency | 이해관계자 관점 핵심 성과 지표 |
| CostReduction | 비용 최적화 관점 지표 |
| ROI | 투자 대비 수익 지표 |
| CustomerSatisfaction | 고객/이해관계자 만족도 지표 |

## 결과

### 긍정적 영향

- 구조적 역방향 추적으로 근본원인 분석 가능
- AI/LLM에 명확한 컨텍스트 제공
- 데이터 품질 자동 검증 기준 확보
- 직관적인 Cypher 경로 쿼리

### 부정적 영향

- 새로운 데이터 유형 추가 시 어떤 계층에 배치할지 판단 필요
- 계층 간 관계 방향 규칙 준수 부담
- 인제스트 파이프라인이 매핑 규칙을 정확히 구현해야 함

## 재검토 조건

- 특정 산업 도메인의 Process 유형이 현재 유형으로 표현 불가할 때
- 5번째 계층 (예: Strategy, Regulatory) 필요성이 실무에서 확인될 때
- 계층 간 관계 규칙이 실제 데이터 표현을 지나치게 제약할 때
- 다른 Axiom 사용 조직에서 4계층 구조가 적합하지 않을 때
