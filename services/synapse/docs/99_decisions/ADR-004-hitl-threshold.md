# ADR-004: HITL 신뢰도 임계값 (0.75) 결정

## 상태

Accepted

## 배경

비정형 문서에서 온톨로지를 추출할 때, GPT-4o가 각 개체/관계에 신뢰도 점수(0.0-1.0)를 부여한다. 이 점수를 기준으로 자동 반영(Neo4j 커밋)과 인간 검토(HITL) 대상을 결정해야 한다.

임계값이 너무 높으면: 인간 검토 부담 증가, 자동화 이점 감소
임계값이 너무 낮으면: 부정확한 데이터가 온톨로지에 반영, 데이터 품질 저하

비즈니스 프로세스 인텔리전스 도메인은 경영 의사결정에 사용되므로 데이터 정확성이 특히 중요하다.

## 검토한 옵션

### 옵션 1: 임계값 0.75

- 0.75 이상: 자동 반영 (verified=false, 추후 확인 가능)
- 0.50-0.74: HITL 검토 필요 (검토 대기열)
- 0.50 미만: HITL 검토 필수 + 저신뢰 경고

### 옵션 2: 임계값 0.90

- 매우 보수적
- 대부분의 추출 결과가 HITL 대기열로 이동
- 자동 반영 비율: 추정 30-40%

### 옵션 3: 임계값 0.60

- 공격적
- 대부분 자동 반영
- 자동 반영 비율: 추정 80-90%
- 부정확한 데이터 유입 위험 높음

### 옵션 4: 임계값 없음 (모두 HITL)

- 모든 추출 결과를 인간이 검토
- 최고 품질 보장
- 비용: 추출의 자동화 이점 없음

### 옵션 5: 적응형 임계값

- 개체 유형별로 다른 임계값 적용
- 금액: 0.90 (오류 영향 큼), 기업명: 0.70 (비교적 안전)
- 단점: 복잡성 증가, 설정 관리 부담

## 선택한 결정

**옵션 1: 임계값 0.75** 를 선택한다.

## 근거

### 1. K-AIR 3단계 신뢰도 패턴과의 일관성

K-AIR에서 사용한 신뢰도 3단계:
- 99% 이상: 완전 자동
- 80% 이상: 조건부 자동
- 80% 미만: 인간 검토

Axiom은 LLM 기반 추출이므로 K-AIR보다 낮은 기준이 합리적이다. LLM의 신뢰도 점수 분포가 규칙 기반 시스템보다 넓기 때문에 80% → 75%로 조정.

### 2. 예상 분포 기반 비용 분석

내부 테스트 (비즈니스 보고서 5건)에서의 GPT-4o 신뢰도 점수 분포:

| 신뢰도 범위 | 비율 | 임계값별 처리 |
|-----------|------|------------|
| 0.90-1.00 | ~45% | 모두: 자동 반영 |
| 0.75-0.89 | ~25% | **0.75**: 자동 반영 / 0.90: HITL |
| 0.50-0.74 | ~20% | 모두: HITL |
| 0.00-0.49 | ~10% | 모두: HITL |

| 임계값 | 자동 반영 비율 | HITL 비율 | 검토 부담/문서 |
|-------|-------------|----------|-------------|
| 0.90 | ~45% | ~55% | ~19개 개체/문서 |
| **0.75** | **~70%** | **~30%** | **~10개 개체/문서** |
| 0.60 | ~85% | ~15% | ~5개 개체/문서 |

**0.75에서 자동 반영 70%, HITL 30%**. 문서당 평균 10개 개체 검토는 관리 가능한 수준.

### 3. 오류 영향도 분석

| 오류 유형 | 영향 | 0.75 임계값에서의 빈도 |
|----------|------|---------------------|
| 기업명 오인식 | 중 (수정 가능) | 희박 (대부분 0.9+) |
| 금액 오류 | 높음 (의사결정 영향) | 희박 (숫자 정규화 검증) |
| 프로세스 유형 오분류 | 중 (구조 오류) | 가끔 (유사 용어 혼동) |
| 관계 방향 오류 | 높음 (계층 구조 위반) | 규칙 기반 검증으로 차단 |

0.75 이상에서 자동 반영되는 개체는 대부분 명확한 고유명사(기업명, 부서명)와 정확한 수치(금액, 일자)로, 오류 위험이 낮다.

### 4. 보완 장치

자동 반영된 개체(verified=false)는:
- 프로세스 분석가가 사후에 확인할 수 있음
- 온톨로지 브라우저에서 "미확인" 표시로 구분
- 정기적 품질 감사에서 샘플 검토

## 결과

### 긍정적 영향

- 추출 결과의 70%가 자동 반영되어 자동화 이점 확보
- 문서당 평균 10개 개체만 인간 검토 (관리 가능)
- K-AIR 패턴과 일관된 사용자 경험

### 부정적 영향

- 0.75-0.89 구간에서 간헐적 오류가 자동 반영될 가능성 (추정 5% 미만)
- 프로세스 분석가 사후 확인 프로세스 필요

### 완화 방안

- verified=false 노드에 대한 사후 확인 워크플로우
- 금액/일자 등 정량 데이터는 규칙 기반 추가 검증 (범위, 형식)
- 계층 방향 규칙 위반은 임계값 무관하게 차단
- 분기별 임계값 효과 분석 → 조정 가능

## 재검토 조건

- 자동 반영된 개체의 오류율이 5%를 초과할 때
- HITL 검토 인력이 부족하여 대기열이 100건 이상 적체될 때
- 새로운 문서 유형 (예: 영문 계약서)에서 신뢰도 분포가 크게 달라질 때
- GPT-4o 모델 업데이트로 신뢰도 점수 분포가 변할 때
- 사용자(프로세스 분석가, 의사결정권자)로부터 데이터 정확도 불만이 접수될 때
- 적응형 임계값(옵션 5)의 구현 비용이 충분히 낮아질 때
