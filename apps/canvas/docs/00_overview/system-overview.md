# Axiom Canvas - 시스템 개요

<!-- affects: all -->
<!-- requires-update: 01_architecture/architecture-overview.md, 04_frontend/process-designer.md -->

## 이 문서가 답하는 질문

- Axiom Canvas란 무엇인가?
- Canvas가 해결하는 문제는 무엇인가?
- 어떤 사용자가, 어떤 맥락에서 Canvas를 사용하는가?
- Canvas의 8대 기능 영역은 무엇이며 각각 어떤 백엔드 서비스와 연결되는가?

---

## 1. 프로젝트 정의

### 1.1 Axiom 플랫폼 내 Canvas의 위치

```
┌──────────────────────────────────────────────────────────────────────┐
│                        Axiom 플랫폼                                  │
│                                                                      │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────────────────┐  │
│  │  Core 서비스  │  │ Vision 서비스 │  │    Oracle 서비스          │  │
│  │  (케이스/문서) │  │ (시나리오/OLAP)│  │    (NL2SQL/데이터분석)   │  │
│  └──────┬───────┘  └──────┬───────┘  └──────────┬───────────────┘  │
│         │                  │                      │                  │
│  ┌──────┴───────┐  ┌──────┴───────┐  ┌──────────┴───────────────┐  │
│  │ Synapse 서비스│  │ Weaver 서비스│  │                          │  │
│  │ (온톨로지)    │  │ (데이터소스) │  │                          │  │
│  └──────┬───────┘  └──────┬───────┘  │                          │  │
│         │                  │          │                          │  │
│  ┌──────▼──────────────────▼──────────▼──────────────────────┐  │  │
│  │                                                            │  │  │
│  │               ★ Canvas (프론트엔드 모듈) ★                 │  │  │
│  │                                                            │  │  │
│  │  "문서를 그리고 다듬는 창의적 작업 공간"                   │  │  │
│  │                                                            │  │  │
│  │  React 18 + TypeScript + Shadcn/ui + Zustand              │  │  │
│  │  + react-konva + Yjs (실시간 협업 프로세스 디자이너)      │  │  │
│  │                                                            │  │  │
│  └────────────────────────────────────────────────────────────┘  │  │
│                                                                      │
└──────────────────────────────────────────────────────────────────────┘
```

**Axiom**은 범용 비즈니스 프로세스 인텔리전스(Business Process Intelligence) AI 데이터 플랫폼이다. 의사결정권자, 프로세스 분석가, 이해관계자(Stakeholder) 등 다양한 참여자가 비즈니스 프로세스에서 생성되는 대량의 문서와 데이터를 AI의 도움으로 처리하고 분석할 수 있도록 지원한다.

**Axiom Canvas**는 이 플랫폼의 **웹 프론트엔드 모듈**이다. "문서를 그리고 다듬는 창의적 작업 공간"이라는 비전 하에, 단순한 데이터 뷰어가 아닌 **사용자가 AI와 협업하여 문서를 작성, 검토, 분석하는 능동적 인터페이스**를 목표로 한다.

### 1.2 Canvas라는 이름의 의미

| 은유 | 의미 |
|------|------|
| **캔버스(화포)** | 문서를 "그리는" 공간 - 단순 입력이 아닌 구성과 편집 |
| **작업대** | 여러 도구(AI, OLAP, 그래프)를 펼쳐놓고 동시에 작업 |
| **리뷰 테이블** | HITL(Human-in-the-Loop) 방식으로 AI 결과물을 인간이 다듬는 장소 |

### 1.3 K-AIR에서 Axiom Canvas로의 진화

Canvas는 기존 K-AIR(레거시 AI 데이터 플랫폼)의 4개 프론트엔드 소스를 **하나의 통합 React 애플리케이션**으로 재작성한다.

| K-AIR 소스 | Canvas 대응 영역 | 전환 전략 |
|------------|-------------------|-----------|
| process-gpt-vue3 (SpikeAdmin) | 케이스 대시보드, 문서 관리, HITL | Vue3+Vuetify -> React+Shadcn/ui |
| robo-data-fabric/frontend | 데이터소스 관리 | Vue3+Headless UI -> React+Shadcn/ui |
| data-platform-olap/frontend | OLAP 피벗, NL2SQL, 온톨로지 | Vue3+Tailwind -> React+Shadcn/ui |
| eventstorming-tool (핵심 이식 대상) | 비즈니스 프로세스 디자이너, 실시간 협업 | Vue3+Konva.js+Yjs -> React+react-konva+Yjs |

---

## 2. 사용자 역할 정의

### 2.1 주요 사용자 유형

| 역할 | 설명 | Canvas에서의 주요 활동 |
|------|------|------------------------|
| **프로세스 분석가** | 비즈니스 프로세스 관리 책임자 | 케이스 대시보드 모니터링, 문서 최종 승인, Watch 알림 확인, 비즈니스 프로세스 모델링/분석 |
| **도메인 전문가** | 업무 문서 작성/검토 | 문서 작성, HITL 리뷰, AI 생성 문서 검증 |
| **재무 분석가** | 재무 데이터 분석 | OLAP 피벗 분석, What-if 시나리오, NL2SQL 쿼리 |
| **데이터 엔지니어** | 데이터 파이프라인 관리 | 데이터소스 설정, 온톨로지 매핑, 쿼리 최적화 |
| **시스템 관리자** | 플랫폼 운영 | 사용자/권한 관리, 시스템 모니터링 |

### 2.2 역할별 접근 영역 매트릭스

```
              대시보드  문서관리  HITL  What-if  OLAP  온톨로지  NL2SQL  Watch  프로세스디자이너  데이터소스
프로세스분석가  ●         ○        ●     ○        ○     -         -       ●      ●                  -
도메인전문가   ○         ●        ●     ○        ○     -         ○       ○      ○                  -
재무분석가     ○         ○        ○     ●        ●     ○         ●       ○      ○                  -
데이터엔지니어  ○         -        -     ○        ●     ●         ●       -      ○                  ●
시스템관리자   ●         ○        -     -        -     -         -       ●      -                  ●

●: 주요 활동 영역  ○: 접근 가능  -: 접근 불필요
```

---

## 3. 8대 기능 영역

### 3.1 기능 영역 전체 맵

```
┌─────────────────────────────────────────────────────────────────┐
│                       Axiom Canvas                               │
│                                                                  │
│  ┌─────────────────────────────────────────────────────────┐    │
│  │  1. 케이스 대시보드               [Core API]            │    │
│  │     - 케이스 목록/상세/타임라인                          │    │
│  │     - 진행률 위젯, 통계 카드                             │    │
│  ├─────────────────────────────────────────────────────────┤    │
│  │  2. 문서 관리 + HITL 리뷰         [Core API]            │    │
│  │     - 문서 CRUD, 버전 관리                               │    │
│  │     - AI 생성 → 인간 검토 → 승인 워크플로우              │    │
│  │     - 인라인 주석, Diff 뷰어                             │    │
│  ├─────────────────────────────────────────────────────────┤    │
│  │  3. What-if 시나리오 빌더          [Vision API]          │    │
│  │     - 매개변수 슬라이더                                   │    │
│  │     - 토네이도 차트 (민감도 분석)                         │    │
│  │     - 시나리오 비교 테이블                                │    │
│  ├─────────────────────────────────────────────────────────┤    │
│  │  4. OLAP 피벗 테이블               [Vision API]          │    │
│  │     - 차원/측정값 드래그앤드롭                            │    │
│  │     - 드릴다운/드릴업                                     │    │
│  │     - 차트 시각화 (Bar, Line, Pie)                       │    │
│  ├─────────────────────────────────────────────────────────┤    │
│  │  5. 온톨로지 브라우저               [Synapse API]        │    │
│  │     - 지식그래프 시각화 (Force-directed)                  │    │
│  │     - 노드 탐색, 관계 필터                                │    │
│  │     - 4계층 (KPI → Measure → Process → Resource)         │    │
│  ├─────────────────────────────────────────────────────────┤    │
│  │  6. NL2SQL 대화형 쿼리              [Oracle API]         │    │
│  │     - 자연어 질문 입력                                    │    │
│  │     - SQL 자동 생성 + 결과 테이블                        │    │
│  │     - 쿼리 히스토리, 저장된 쿼리                          │    │
│  ├─────────────────────────────────────────────────────────┤    │
│  │  7. Watch 알림 대시보드             [Core WebSocket]     │    │
│  │     - 실시간 알림 피드                                    │    │
│  │     - 알림 규칙 설정                                      │    │
│  │     - 이벤트 타임라인                                     │    │
│  ├─────────────────────────────────────────────────────────┤    │
│  │  8. 비즈니스 프로세스 디자이너      [Synapse API + Yjs]  │    │
│  │     - EventStorming 기반 프로세스 모델링 캔버스           │    │
│  │     - 8종 비즈니스 노드 + 3종 확장 노드                  │    │
│  │     - react-konva 기반 실시간 협업 (Yjs CRDT)            │    │
│  │     - 프로세스 마이닝 결과 오버레이                       │    │
│  └─────────────────────────────────────────────────────────┘    │
│                                                                  │
│  ┌─────────────────────────────────────────────────────────┐    │
│  │  + 데이터소스 관리                  [Weaver API]         │    │
│  │     - 데이터소스 연결 설정                                │    │
│  │     - 메타데이터 탐색                                     │    │
│  │     - 동기화 상태 모니터링                                │    │
│  └─────────────────────────────────────────────────────────┘    │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

### 3.2 기능 영역별 상세

#### 1) 케이스 대시보드

| 항목 | 내용 |
|------|------|
| **목적** | 비즈니스 프로젝트/케이스의 전체 현황을 한눈에 파악 |
| **데이터 소스** | Core API (`/api/v1/cases`) |
| **K-AIR 원본** | process-gpt-vue3 `/dashboard` 라우트 |
| **핵심 위젯** | 통계 카드 4종, 케이스 목록 테이블, 타임라인, 진행률 바 |
| **실시간** | Core WebSocket으로 케이스 상태 변경 수신 |

#### 2) 문서 관리 + HITL 리뷰

| 항목 | 내용 |
|------|------|
| **목적** | AI가 생성한 업무 문서를 인간이 검토/수정/승인 |
| **데이터 소스** | Core API (`/api/v1/documents`, `/api/v1/reviews`) |
| **K-AIR 원본** | process-gpt-vue3 Memento 서비스 연동 부분 |
| **핵심 기능** | 문서 편집기, Diff 뷰어, 인라인 주석, 승인 워크플로우 |
| **HITL 흐름** | AI 초안 생성 -> 검토자 배정 -> 인라인 코멘트 -> 수정 -> 최종 승인 |

#### 3) What-if 시나리오 빌더

| 항목 | 내용 |
|------|------|
| **목적** | 비용 배분율, 실행 계획 등의 변수를 조정하여 결과 시뮬레이션 |
| **데이터 소스** | Vision API (`/api/v1/scenarios`) |
| **K-AIR 원본** | data-platform-olap What-if 시뮬레이션 (미구현 -> 신규 개발) |
| **핵심 기능** | 매개변수 슬라이더, 토네이도 차트, 시나리오 비교, 민감도 분석 |

#### 4) OLAP 피벗 테이블

| 항목 | 내용 |
|------|------|
| **목적** | 재무 데이터의 다차원 분석 (드릴다운, 피벗, 슬라이스/다이스) |
| **데이터 소스** | Vision API (`/api/v1/olap`) |
| **K-AIR 원본** | data-platform-olap PivotEditor, PivotTable 컴포넌트 |
| **핵심 기능** | 차원/측정값 DnD, 행/열 피벗, 필터, 차트 전환 |

#### 5) 온톨로지 브라우저

| 항목 | 내용 |
|------|------|
| **목적** | 도메인 지식그래프를 시각적으로 탐색 |
| **데이터 소스** | Synapse API (`/api/v1/ontology`) |
| **K-AIR 원본** | data-platform-olap DataLineage + Neo4j 그래프 |
| **핵심 기능** | Force-directed 그래프, 노드 클릭 상세, 경로 하이라이트, 4계층 필터 |

#### 6) NL2SQL 대화형 쿼리

| 항목 | 내용 |
|------|------|
| **목적** | 자연어로 데이터베이스 질의 - "지난 분기 부채비율 상위 10개 기업은?" |
| **데이터 소스** | Oracle API (`/api/v1/nl2sql`) |
| **K-AIR 원본** | data-platform-olap NaturalQuery 컴포넌트 + robo-data-text2sql |
| **핵심 기능** | 채팅 UI, SQL 프리뷰, 결과 테이블, 차트 자동 추천, 쿼리 저장 |

#### 7) Watch 알림 대시보드

| 항목 | 내용 |
|------|------|
| **목적** | 케이스 상태 변경, 기한 초과, 이상 탐지 등 실시간 알림 |
| **데이터 소스** | Core WebSocket (`ws://core/events`) |
| **K-AIR 원본** | process-gpt-vue3 Socket.io 이벤트 버스 |
| **핵심 기능** | 알림 피드, 규칙 설정, 이벤트 필터, 읽음 처리, 우선순위 분류 |

#### 8) 비즈니스 프로세스 디자이너

| 항목 | 내용 |
|------|------|
| **목적** | 비즈니스 프로세스를 EventStorming 방식으로 시각적으로 모델링하고, 프로세스 마이닝 결과와 연결하여 분석 |
| **데이터 소스** | Synapse API (`/api/v1/process-mining`), Yjs WebSocket (`ws://yjs/collaboration`) |
| **K-AIR 원본** | eventstorming-tool-vite-main (Vue3+Konva.js+Yjs) -- 핵심 이식 대상 |
| **핵심 기능** | react-konva 캔버스, 8종 비즈니스 노드(Domain/Action/Event/Entity/Rule/Stakeholder/Report/Measure), 3종 확장 노드(Measure/EventLogBinding/TemporalAnnotation), 연결선 4종(triggers/reacts_to/produces/binds_to), Yjs CRDT 실시간 협업, 프로세스 마이닝 결과 오버레이 |
| **실시간** | Yjs WebSocket으로 다중 사용자 동시 편집 (커서 공유, 충돌 해소) |

**사용자 시나리오**: 프로세스 분석가가 비즈니스 프로세스를 시각적으로 모델링한다. 비즈니스 이벤트, 액션, 엔티티, 규칙 노드를 캔버스에 배치하고 연결선으로 흐름을 정의한다. 이벤트 로그를 바인딩하면 프로세스 마이닝 결과(병목, 이탈, 적합도)가 캔버스 위에 오버레이된다. 여러 분석가가 Yjs를 통해 동시에 편집하며, 온톨로지 브라우저의 Process 계층 노드와 시각적으로 연결된다.

#### +) 데이터소스 관리

| 항목 | 내용 |
|------|------|
| **목적** | 외부 데이터베이스 연결 설정 및 메타데이터 동기화 |
| **데이터 소스** | Weaver API (`/api/v1/datasources`) |
| **K-AIR 원본** | robo-data-fabric/frontend DataSources 뷰 |
| **핵심 기능** | 연결 문자열 설정, 테스트, 스키마 탐색, 동기화 진행률 |

---

## 4. 백엔드 서비스 의존성

### 4.1 Canvas -> 백엔드 서비스 매핑

```
Canvas 기능 영역              백엔드 서비스            프로토콜
─────────────────────────    ────────────────────    ──────────
케이스 대시보드         ───→  Core 서비스              REST + WS
문서 관리 + HITL        ───→  Core 서비스              REST
What-if 시나리오        ───→  Vision 서비스            REST
OLAP 피벗              ───→  Vision 서비스            REST
온톨로지 브라우저       ───→  Synapse 서비스           REST
NL2SQL 대화형 쿼리     ───→  Oracle 서비스            REST + SSE
Watch 알림             ───→  Core 서비스              WebSocket
비즈니스 프로세스 디자이너 ──→ Synapse 서비스           REST + Yjs WS
데이터소스 관리        ───→  Weaver 서비스            REST + SSE
```

### 4.2 서비스별 역할

| 서비스 | 위치 | 역할 | 주요 엔드포인트 |
|--------|------|------|-----------------|
| **Core** | `/services/core` | 케이스/문서/사용자/인증/알림 중앙 관리 | `/cases`, `/documents`, `/reviews`, `/users` |
| **Vision** | `/services/vision` | 시나리오 분석, OLAP 큐브 | `/scenarios`, `/olap/query`, `/olap/cubes` |
| **Oracle** | `/services/oracle` | NL2SQL 변환, 쿼리 실행 | `/nl2sql/ask`, `/nl2sql/history` |
| **Synapse** | `/services/synapse` | 온톨로지/지식그래프 관리 | `/ontology/nodes`, `/ontology/paths` |
| **Weaver** | `/services/weaver` | 데이터소스 연결/메타데이터 | `/datasources`, `/metadata/sync` |

---

## 5. 기술 스택 요약

### 5.1 결정된 기술 스택

| 분류 | 기술 | 버전 | 결정 근거 (ADR 참조) |
|------|------|------|---------------------|
| UI 프레임워크 | React | 18.x | ADR-001: 생태계, 인력풀, 타입 안전성 |
| 언어 | TypeScript | 5.x | 타입 안전성, 리팩토링 용이 |
| 상태 관리 | Zustand | 4.x | ADR-003: 간결한 API, React 외부 접근 |
| 서버 상태 | TanStack Query | 5.x | ADR-004: 캐싱, 재시도, 무한 스크롤 |
| 라우팅 | React Router | 6.x | ADR-005: 중첩 라우트, 코드 분할 |
| UI 컴포넌트 | Shadcn/ui | latest | ADR-002: 소유 가능한 컴포넌트, Tailwind 기반 |
| 스타일링 | Tailwind CSS | 3.x | 유틸리티 우선, Shadcn/ui 호환 |
| 빌드 | Vite | 5.x | 빠른 HMR, ESM 기반 |
| 차트 | Recharts | 2.x | React 네이티브, 선언적 API |
| 그래프 | React Force Graph | 1.x | 온톨로지 시각화 |
| 캔버스 | react-konva | 18.x | 비즈니스 프로세스 디자이너 (ADR-006) |
| 실시간 협업 | Yjs + y-websocket | 13.x | CRDT 기반 다중 사용자 동시 편집 |
| 테이블 | TanStack Table | 8.x | 헤드리스, 가상 스크롤 |
| 폼 | React Hook Form + Zod | - | 성능, 타입 안전 검증 |

### 5.2 Vue 3 -> React 18 전환 매핑

| Vue 3 개념 | React 18 대응 | 비고 |
|-------------|---------------|------|
| `<template>` | JSX/TSX | XML-like -> JS 표현식 |
| `ref()` / `reactive()` | `useState` / Zustand store | 반응성 시스템 차이 |
| `computed()` | `useMemo` / Zustand selector | 파생 상태 |
| `watch()` / `watchEffect()` | `useEffect` | 부수효과 |
| Pinia store | Zustand store | 유사한 단순성 |
| Vue Router | React Router v6 | 중첩 라우트 방식 차이 |
| `<Suspense>` | React `<Suspense>` | 비동기 컴포넌트 |
| `<Teleport>` | React Portal | 모달/팝오버 |
| `provide/inject` | React Context | 의존성 주입 |
| Vuetify / Headless UI | Shadcn/ui | 컴포넌트 라이브러리 |
| `mitt()` 이벤트 버스 | Zustand / Custom Event | 전역 이벤트 |
| Composition API | Custom Hooks | 로직 재사용 |
| vue-konva | react-konva | 동일 Konva.js 엔진, 래퍼만 교체 |
| Yjs + y-websocket | Yjs + y-websocket | 프레임워크 무관, 그대로 유지 |

---

## 6. 용어집 (Glossary)

| 용어 | 정의 |
|------|------|
| **케이스(Case)** | 하나의 비즈니스 프로세스/프로젝트. 고유 번호, 관련 문서, 참여자 정보를 포함 |
| **HITL** | Human-in-the-Loop. AI 출력을 인간이 검증하는 품질 보증 패턴 |
| **온톨로지** | 도메인 개념과 관계를 정형화한 지식 체계. Neo4j 그래프로 표현 |
| **피벗 테이블** | 다차원 데이터를 행/열로 재배치하여 집계하는 분석 도구 |
| **NL2SQL** | Natural Language to SQL. 자연어 질문을 SQL 쿼리로 변환 |
| **What-if 분석** | 입력 변수를 변경했을 때 결과가 어떻게 달라지는지 시뮬레이션 |
| **토네이도 차트** | 변수별 민감도를 막대 길이로 표현하는 시각화 |
| **드릴다운** | 집계 데이터에서 더 상세한 하위 수준으로 내려가는 OLAP 연산 |
| **Watch** | 특정 조건을 감시하고 조건 충족 시 알림을 발생시키는 기능 |
| **데이터소스** | 외부 데이터베이스 연결 정보 (PostgreSQL, MySQL, Oracle 등) |
| **BFF** | Backend-for-Frontend. 프론트엔드 요구에 최적화된 백엔드 계층 |
| **Zustand** | 경량 React 상태 관리 라이브러리 (독일어로 "상태") |
| **Shadcn/ui** | 소유 가능한(copy-paste) React 컴포넌트 컬렉션 |
| **TanStack Query** | 서버 상태 관리 (캐싱, 재시도, 동기화) 라이브러리 |
| **EventStorming** | 도메인 이벤트 중심으로 비즈니스 프로세스를 시각적으로 모델링하는 워크숍 기법 |
| **CRDT** | Conflict-free Replicated Data Type. 충돌 없는 분산 데이터 동기화 알고리즘 |
| **Yjs** | CRDT 기반 실시간 협업 프레임워크. 다중 사용자 동시 편집 지원 |
| **react-konva** | HTML5 Canvas 라이브러리 Konva.js의 React 래퍼. 2D 도형/텍스트 렌더링 |
| **프로세스 마이닝** | 이벤트 로그에서 실제 프로세스 흐름을 발견/분석하는 기법 |
| **적합도(Conformance)** | 설계된 프로세스 모델과 실제 실행 로그 간의 일치 정도 |
| **SSE** | Server-Sent Events. 서버 -> 클라이언트 단방향 실시간 스트림 |

---

## 7. 문서 체계 안내

본 문서는 Canvas 모듈 기술 문서의 진입점이다. 상세 내용은 아래 문서를 참조한다.

| 카테고리 | 문서 | 대상 독자 |
|----------|------|-----------|
| `01_architecture/` | 아키텍처 설계 | 전체 개발자 |
| `02_api/` | API 클라이언트, 계약 | 프론트엔드/백엔드 |
| `03_backend/` | BFF 계층 | 풀스택 |
| `04_frontend/` | UI 설계 상세 | 프론트엔드 |
| `05_llm/` | AI 기능 명세 | AI/프론트엔드 |
| `06_data/` | 상태/캐시 스키마 | 프론트엔드 |
| `07_security/` | 인증/인가 | 전체 |
| `08_operations/` | 빌드/배포 | DevOps |
| `99_decisions/` | ADR | 전체 |

---

## 변경 이력

| 날짜 | 버전 | 작성자 | 내용 |
|------|------|--------|------|
| 2026-02-20 | 1.1 | Axiom Team | 8번째 기능 영역 비즈니스 프로세스 디자이너 추가, EventStorming 이식 대상 격상, react-konva/Yjs 기술 스택 추가 |
| 2026-02-19 | 1.0 | Axiom Team | 초기 작성 |
